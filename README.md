# Rails Knockout Questionnaire

This project represents an offline capable webapp and server app for conducting research questionnaires. The front-end webapp is written using knockout.js with offline capabilities provided by appcache. The server is a Ruby on Rails app.

A demo of the system is available on heroku: 

http://rails-knockout-questionnaire.herokuapp.com/

Information on how to login and use the app is available on the homepage of the demo.

The questionnaire is a multi-step wizard with the structure of steps and measures defined in yaml files on the server. For demo purposes the questionnaire concerns apples, but the app would be suitable for any market or academic research.

Using the front end webapp researchers can:

- log in to the system with a 4 digit pin code
- add participants and enter their basic information
- Complete questionnaire data collection for the participant.

The webapp allows the researcher to perform these tasks while offline, and to sync the captured data to the server when an internet connection is available.

The demo quesitonnaire includes an screening step, participant consent page and the a series of measures concerning the participants opinions on and relationship with apples.

# Architecture

The front end webapp uses the knockout.js library to create an interface for capturing participant data. The data is stored locally on the mobile devive using string values in localstorage.

On first loading the webapp, the generated html, javascript, css and image assets are stored in the browsers cache as defined in the appcache manifest. This means that if the page is refreshed when offline the app will still appear.

When the server is available, the app will allow the researcher to sync the participant data, which is sent as json via an ajax request to the rails server.

The rails server will then store the participant data along with their questionnaire responses in the database.

The html and javascript for the front end webapp are generated by the rails app using a mixture of static assets and dynamic data generated from erb files. The dynamic data includes:

- The measure and step definitions, generated from yaml files
- The researcher logins, generated from the database
- A unique installation id

The installation id allows multiple client webapps to capture participant data and synchronise with the same server.


# Source code

The questionare steps are defined in yaml files in the config directory:

[/config/steps.yml](../config/steps.yml)

This file defines the order of the questionnaire steps, and for each step the measures, any introductory text and rule definitions for whether the step is visible

[/config/measures.yml](../config/measures.yml)

This file defines for each measure it's type and question text, any options it has as well as rules for display and visibility

The yaml is used to generate json for the front end webapp as well as used for displaying participant responses on the server.

The javascript source code for the front end webapp is available in the directory

[/public/js](../public/js)

The public directory is used rather than the rails asset pipeline to simplify the process of using appcache for the client assets.

The html for the front end app is generated from rails views and partials which live in

[/app/views/webapps](../app/views/webapps)

with the appcache generated from the file

[/app/views/webapps/appcache.erb](../app/views/webapps/appcache.erb)

# Licensing

This codebase is the intellectual property of [Daniel Berzon](mailto:danny@berzon.io) and is NOT licensed as open source. It is on a public repository for demonstration purposes only.
